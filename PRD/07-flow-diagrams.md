# 社交功能 PRD - 详细流程与状态机

## 1. 好友关系状态机
**状态**
- none：无关系
- pending_out：已发出请求
- pending_in：收到请求
- accepted：好友关系
- blocked：已拉黑

**迁移**
- none -> pending_out：发送好友请求
- none -> pending_in：收到好友请求
- pending_out -> accepted：对方同意
- pending_in -> accepted：本人同意
- pending_in -> none：本人拒绝
- accepted -> blocked：拉黑
- blocked -> none：解除拉黑（可选）

## 2. 好友请求流程
1) 用户 A 输入手机号/邀请码 → 发送请求  
2) 用户 B 收到通知/列表提示  
3) 用户 B 选择同意/拒绝  
4) 双方列表更新为 accepted/none

## 3. 授权详情流程
**请求授权**
1) A 在好友详情页点击“申请查看详情”
2) B 收到授权请求
3) B 同意 → A 获得详情可见；B 拒绝 → 状态提示“未授权”

**撤回授权**
1) B 在授权管理中撤回
2) A 详情区变为“未授权”

## 4. 提醒流程
1) A 在好友列表点击“提醒”  
2) 校验：好友未打卡 & 当日未超过提醒次数  
3) 发送提醒通知  
4) 记录 reminder，更新限频状态

## 5. 打气流程
1) A 在好友列表/详情点击打气  
2) 选择表情（可选附言）  
3) 发送鼓励，B 收到通知  
4) 记录 encouragement

## 6. 群组提醒流程（可选）
1) 群主点击“群提醒”  
2) 系统筛选未打卡成员  
3) 给成员发送通知  
4) 记录 reminder（group）

## 7. 附近展示流程（可选）
1) 用户开启“附近展示”  
2) 服务端保存位置与可见性  
3) 附近列表按距离/时间输出匿名卡片  
4) 用户可匿名打气（不建立关系）
